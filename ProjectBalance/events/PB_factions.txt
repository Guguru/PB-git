###################################
#
# Faction events
#
###################################

#AI determines whether to join autonomy faction
character_event = {
	id = meneth.211
	is_triggered_only = yes
	
	desc = meneth.211.desc
	picture = GFX_evt_battle
	border = GFX_event_normal_frame_religion
	
	trigger = {
		NOT = { has_character_flag = desires_autonomy }
		ai = yes
		independent = no
		is_adult = yes
		is_landed = yes
		OR = {
			higher_tier_than = baron
			is_patrician = yes
		}
		liege = {
			is_feudal = yes
			OR = {
				current_heir = { NOT = { character = ROOT } }
				has_law = succ_feudal_elective
			}
			OR = {
				tier = king
				tier = emperor
			}
			OR = { #Ensures someone at least moderately strong creates the faction
				any_vassal = { leads_faction = faction_autonomy }
				ROOT = { tier = duke }
				ROOT = { tier = king }
				NOT = { any_vassal = { tier = duke } }
			}
		}
		#Character needs some reason to join
		OR = {
			trait = ambitious
			trait = envious
			trait = deceitful
			trait = greedy
			NOT = { opinion = { who = LIEGE value = 0 } }
			crownlaw_title = { has_law = king_peace_2 }
			crownlaw_title = { has_law = emperor_peace_2 }
			crownlaw_title = { has_law = revokation_2 }
			tier = king
		}
	}
	option = {
		name = OK
		set_variable = { which = "autonomy_desire" value = 0 }
		if = {
			limit = { tier = duke }
			change_variable = { which = "autonomy_desire" value = 5 }
		}
		if = {
			limit = { tier = king }
			change_variable = { which = "autonomy_desire" value = 15 }
		}
		if = {
			limit = { liege = { dynasty = ROOT } }
			change_variable = { which = "autonomy_desire" value = -5 }
		}
		if = {
			limit = { liege = { is_close_relative = ROOT } }
			change_variable = { which = "autonomy_desire" value = -5 }
		}
		if = {
			limit = { NOT = { opinion = { who = LIEGE value = -10 } } }
			change_variable = { which = "autonomy_desire" value = 5 }
		}
		if = {
			limit = { NOT = { opinion = { who = LIEGE value = -30 } } }
			change_variable = { which = "autonomy_desire" value = 5 }
		}
		if = {
			limit = { NOT = { opinion = { who = LIEGE value = -50 } } }
			change_variable = { which = "autonomy_desire" value = 5 }
		}
		if = {
			limit = { NOT = { opinion = { who = LIEGE value = -75 } } }
			change_variable = { which = "autonomy_desire" value = 5 }
		}
		if = {
			limit = { opinion = { who = LIEGE value = 10 } }
			change_variable = { which = "autonomy_desire" value = -3 }
		}
		if = {
			limit = { opinion = { who = LIEGE value = 30 } }
			change_variable = { which = "autonomy_desire" value = -3 }
		}
		if = {
			limit = { opinion = { who = LIEGE value = 50 } }
			change_variable = { which = "autonomy_desire" value = -3 }
		}
		if = {
			limit = { opinion = { who = LIEGE value = 75 } }
			change_variable = { which = "autonomy_desire" value = -3 }
		}
		if = {
			limit = { 
				has_opinion_modifier = {
					who = LIEGE
					modifier = opinion_coerced_into_leaving_faction
				}
			}
			change_variable = { which = "autonomy_desire" value = -20 }
		}
		if = {
			limit = { crownlaw_title = { has_law = king_peace_1 } }
			change_variable = { which = "autonomy_desire" value = 5 }
		}
		if = {
			limit = { crownlaw_title = { has_law = king_peace_2 } }
			change_variable = { which = "autonomy_desire" value = 10 }
		}
		if = {
			limit = { crownlaw_title = { has_law = emperor_peace_1 } }
			change_variable = { which = "autonomy_desire" value = 8 }
		}
		if = {
			limit = { crownlaw_title = { has_law = emperor_peace_2 } }
			change_variable = { which = "autonomy_desire" value = 16 }
		}
		if = {
			limit = { crownlaw_title = { has_law = hre_law_0 } }
			change_variable = { which = "autonomy_desire" value = 10 }
		}
		if = {
			limit = { crownlaw_title = { has_law = revokation_1 } }
			change_variable = { which = "autonomy_desire" value = 8 }
		}
		if = {
			limit = { crownlaw_title = { has_law = revokation_2 } }
			change_variable = { which = "autonomy_desire" value = 10 }
		}
		if = {
			limit = { crownlaw_title = { has_law = crown_levies_1 } }
			change_variable = { which = "autonomy_desire" value = 2 }
		}
		if = {
			limit = { crownlaw_title = { has_law = crown_levies_2 } }
			change_variable = { which = "autonomy_desire" value = 5 }
		}
		if = {
			limit = { crownlaw_title = { has_law = crown_levies_3 } }
			change_variable = { which = "autonomy_desire" value = 8 }
		}
		if = {
			limit = { crownlaw_title = { has_law = crown_levies_4 } }
			change_variable = { which = "autonomy_desire" value = 10 }
		}
		if = {
			limit = { crownlaw_title = { has_law = inheritance_1 } }
			change_variable = { which = "autonomy_desire" value = 3 }
		}
		if = {
			limit = { trait = content }
			change_variable = { which = "autonomy_desire" value = -30 }
		}
		if = {
			limit = { trait = imbecile }
			change_variable = { which = "autonomy_desire" value = -25 }
		}
		if = {
			limit = { trait = inbred }
			change_variable = { which = "autonomy_desire" value = -25 }
		}
		if = {
			limit = { trait = craven }
			change_variable = { which = "autonomy_desire" value = -20 }
		}
		if = {
			limit = { trait = slow }
			change_variable = { which = "autonomy_desire" value = -15 }
		}
		if = {
			limit = { trait = kind }
			change_variable = { which = "autonomy_desire" value = -5 }
		}
		if = {
			limit = { trait = charitable }
			change_variable = { which = "autonomy_desire" value = -5 }
		}
		if = {
			limit = { trait = honest }
			change_variable = { which = "autonomy_desire" value = -5 }
		}
		if = {
			limit = { trait = humble }
			change_variable = { which = "autonomy_desire" value = -3 }
		}
		if = {
			limit = { trait = just }
			change_variable = { which = "autonomy_desire" value = -3 }
		}
		if = {
			limit = { trait = proud }
			change_variable = { which = "autonomy_desire" value = 5 }
		}
		if = {
			limit = { trait = brave }
			change_variable = { which = "autonomy_desire" value = 5 }
		}
		if = {
			limit = { trait = arbitrary }
			change_variable = { which = "autonomy_desire" value = 5 }
		}
		if = {
			limit = { trait = envious }
			change_variable = { which = "autonomy_desire" value = 10 }
		}
		if = {
			limit = { trait = greedy }
			change_variable = { which = "autonomy_desire" value = 10 }
		}
		if = {
			limit = { trait = impaler }
			change_variable = { which = "autonomy_desire" value = 10 }
		}
		if = {
			limit = { trait = deceitful }
			change_variable = { which = "autonomy_desire" value = 10 }
		}
		if = {
			limit = { trait = ambitious }
			change_variable = { which = "autonomy_desire" value = 50 }
		}
		if = {
			limit = { check_variable = { which = autonomy_desire value = 0 } }
			set_character_flag = desires_autonomy
		}
		if = {
			limit = { NOT = { check_variable = { which = autonomy_desire value = -5 } } }
			clr_character_flag = desires_autonomy
		}
	}
}

#Faction meeting
character_event = {
	id = meneth.219
	is_triggered_only = yes
	
	desc = meneth.219.desc
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	trigger = {
		leads_faction = faction_autonomy
	}
	option = {
		name = OK
		set_variable = { which = "autonomy_mood" value = 0 }
		any_faction_backer = {
			limit = { in_faction = faction_autonomy }
			character_event = { id = meneth.220 days = 1 }
		}
		character_event = { id = meneth.220 }
		character_event = { id = meneth.221 days = 3 }
	}
}

#Faction meeting mood
character_event = {
	id = meneth.220
	is_triggered_only = yes
	
	desc = meneth.220.desc
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	option = { #Happy
		name = OK
		FROM = { change_variable = { which = "autonomy_mood" value = 1 } }
		if = {
			limit = { FROM = { character = ROOT } }
			set_character_flag = faction_autonomy_happy
		}
		if = {
			limit = { tier = duke }
			FROM = { change_variable = { which = "autonomy_mood" value = 1 } }
		}
		if = {
			limit = { tier = king }
			FROM = { change_variable = { which = "autonomy_mood" value = 2 } }
		}
		ai_will_do = {
			factor = 2
			modifier = {
				factor = 1.5
				opinion = { who = LIEGE value = 10 }
			}
			modifier = {
				factor = 1.5
				opinion = { who = LIEGE value = 30 }
			}
			modifier = {
				factor = 1.5
				opinion = { who = LIEGE value = 50 }
			}
			modifier = {
				factor = 1.5
				opinion = { who = LIEGE value = 75 }
			}
			modifier = {
				factor = 5
				trait = content
			}
			modifier = {
				factor = 4
				trait = imbecile
			}
			modifier = {
				factor = 4
				trait = inbred
			}
			modifier = {
				factor = 3
				trait = slow
			}
			modifier = {
				factor = 2
				trait = kind
			}
			modifier = {
				factor = 2
				trait = charitable
			}
			modifier = {
				factor = 2
				liege = { dynasty = ROOT }
			}
			modifier = {
				factor = 2
				liege = { is_close_relative = ROOT }
			}
		}
	}
	option = { #Neutral
		name = OK
		if = {
			limit = { FROM = { character = ROOT } }
			set_character_flag = faction_autonomy_neutral
		}
		ai_will_do = {
			factor = 10
		}
	}
	option = { #Angry
		name = OK
		FROM = { change_variable = { which = "autonomy_mood" value = -1 } }
		if = {
			limit = { tier = duke }
			FROM = { change_variable = { which = "autonomy_mood" value = -1 } }
		}
		if = {
			limit = { tier = king }
			FROM = { change_variable = { which = "autonomy_mood" value = -2 } }
		}
		if = {
			limit = { FROM = { character = ROOT } }
			set_character_flag = faction_autonomy_angry
		}
		ai_will_do = {
			factor = 2
			modifier = {
				factor = 2
				NOT = { opinion = { who = LIEGE value = -10 } }
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = LIEGE value = -30 } }
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = LIEGE value = -50 } }
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = LIEGE value = -75 } }
			}
			modifier = {
				factor = 1.5
				crownlaw_title = { has_law = king_peace_1 }
			}
			modifier = {
				factor = 2
				crownlaw_title = { has_law = king_peace_2 }
			}
			modifier = {
				factor = 1.6
				crownlaw_title = { has_law = emperor_peace_1 }
			}
			modifier = {
				factor = 2.5
				crownlaw_title = { has_law = emperor_peace_2 }
			}
			modifier = {
				factor = 1.75
				crownlaw_title = { has_law = revokation_1 }
			}
			modifier = {
				factor = 2
				crownlaw_title = { has_law = revokation_2 }
			}
			modifier = {
				factor = 1.2
				crownlaw_title = { has_law = crown_levies_1 }
			}
			modifier = {
				factor = 1.4
				crownlaw_title = { has_law = crown_levies_2 }
			}
			modifier = {
				factor = 1.7
				crownlaw_title = { has_law = crown_levies_3 }
			}
			modifier = {
				factor = 2
				crownlaw_title = { has_law = crown_levies_4 }
			}
			modifier = {
				factor = 1.3
				crownlaw_title = { has_law = inheritance_1 }
			}
			modifier = {
				factor = 0.75
				trait = kind
			}
			modifier = {
				factor = 0.75
				trait = charitable
			}
			modifier = {
				factor = 0.75
				trait = honest
			}
			modifier = {
				factor = 0.75
				trait = humble
			}
			modifier = {
				factor = 0.75
				trait = just
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = envious
			}
			modifier = {
				factor = 2
				trait = greedy
			}
			modifier = {
				factor = 2
				trait = impaler
			}
			modifier = {
				factor = 2
				trait = deceitful
			}
			modifier = {
				factor = 5
				trait = ambitious
			}
		}
	}
}

#Mood gauged
character_event = {
	id = meneth.221
	is_triggered_only = yes
	
	desc = meneth.221.desc
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_religion
	
	option = { #Happy meeting
		name = meneth.221.a
		trigger = {
			check_variable = { which = "autonomy_mood" value = 0 }
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_character_flag = faction_autonomy_happy
			}
			modifier = {
				factor = 0
				has_character_flag = faction_autonomy_angry
			}
		}
	}
	option = { #Neutral meeting
		name = meneth.221.b
		trigger = {
			check_variable = { which = "autonomy_mood" value = -5 }
			NOT = { check_variable = { which = "autonomy_mood" value = 5 } }
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_character_flag = faction_autonomy_neutral
			}
		}
	}
	option = { #Angry meeting
		name = meneth.221.c
		trigger = {
			NOT = { check_variable = { which = "autonomy_mood" value = 0 } }
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1000
				has_character_flag = faction_autonomy_angry
			}
			modifier = {
				factor = 0
				has_character_flag = faction_autonomy_happy
			}
		}
	}
}